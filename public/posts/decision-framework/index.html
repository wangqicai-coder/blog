<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>决策框架：整合所有概念 | WANG QICAI</title>
<meta name="keywords" content="">
<meta name="description" content="一个核心问题
这个博客的所有文章，都在回答同一个问题：
在不确定的世界里，如何做出好的决策？
我们不能预测未来，我们的知识有限，我们的判断会出错。
在这种情况下，什么是正确的思维方式？

三层框架
这18个概念可以组织成三个层次：
第一层：理解现实
在做任何决策之前，你需要正确理解你面对的世界。
核心洞见：


尾部风险：极端事件比你以为的更常见，影响比你以为的更大。传统风险模型（正态分布）严重低估了尾部。


遍历性：时间平均不等于集合平均。在乘性系统中，一次归零就是永远归零。生存是前提，不是目标。


幸存者偏差：你看到的成功者是经过选择的样本，他们的经验不能简单复制。失败者的教训往往更有价值。


反身性：市场不是被动反映现实，而是主动塑造现实。预期和现实互相影响，形成反馈循环。


林迪效应：在非生物系统中，存活时间本身是生命力的证据。经典比时尚更可靠。


这一层的教训：世界比你想象的更极端、更不可预测、更具欺骗性。大多数人系统性地低估不确定性。

第二层：构建结构
理解现实之后，你需要设计能够在这种现实中生存和繁荣的结构。
核心原则：


凸性：追求不对称性——上行大于下行。在变化中获益，而不是受损。


选择权：保留选项的价值往往超过做出选择的价值。在不确定的世界里，灵活性是资产。


安全边际：为错误留出空间。你会犯错，问题是犯错后是否还能生存。


杠铃策略：不要在中间找平衡，把风险分离到两端。极端安全 &#43; 极端冒险，没有中间。


机会成本：每个选择都有代价。说&quot;是&quot;就是对其他选项说&quot;不&quot;。


这一层的教训：正确的结构比正确的预测更重要。你无法预测未来，但你可以设计一个在多种未来中都能表现良好的系统。

第三层：执行决策
有了正确的理解和结构，你需要在具体情境中做出决策。
核心工具：


能力圈：只在你真正理解的领域做决策。知道自己不知道什么，比知道什么更重要。


利益攸关：只信任有利益攸关的人的建议。没有代价的建议是廉价的。


反向思维：与其问&quot;如何成功&quot;，不如问&quot;如何失败&quot;，然后避开那些事。


凯利公式：根据优势和赔率计算最优下注比例。但在现实中，总是下注低于凯利值。


均值回归：极端值会向均值回归。不要把异常表现外推为永恒趋势。


沉没成本：已付出的成本不应影响未来决策。只看前方，不看后方。


复利：长期持续的小优势，会产生巨大的累积效果。时间是复利的朋友。


期望值：决策的质量看期望值，不看单次结果。好决策可能有坏结果，坏决策可能有好结果。


这一层的教训：决策的目标不是&quot;正确&quot;，而是&quot;可重复的期望值为正&quot;。在你有优势的地方下注，在你没有优势的地方克制。

核心原则
如果把所有概念蒸馏成几条核心原则，它们是：
原则一：生存优先
在遍历性问题上，生存是唯一重要的目标。
其他所有目标——回报、成就、声誉——都建立在生存的基础上。

永远不要让任何单一事件能够摧毁你
宁可错过机会，也不要承担灭顶风险
在生存无忧的前提下，再考虑优化

原则二：追求凸性
设计上行大于下行的处境。
不是预测哪个方向会发生，而是确保：如果好事发生，你能获益更多；如果坏事发生，你损失有限。

买入选择权，而不是卖出选择权
保持灵活性和选项
用安全边际保护下行

原则三：承认无知
你的知识边界比你以为的更窄。

待在能力圈内
对不理解的事情说&quot;不&quot;
让有利益攸关的人教你，而不是没有的人

原则四：反向思考
避免愚蠢比追求聪明更重要。

列出会毁掉你的事，然后不做
从失败案例学习，而不只是成功案例
设置不可违反的硬性规则

原则五：重视时间
时间是不确定性的解药，也是不确定性的来源。

复利需要时间才能显现
林迪效应需要时间来验证
但时间也在衰减你的选择权


决策清单
面对重大决策时，问自己：">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/decision-framework/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.178c09f45df504deadb8ecd2465908a4d20d1336baa5ea67b2f6c3ce3b5cd7c2.css" integrity="sha256-F4wJ9F31BN6tuOzSRlkIpNINEza6pepnsvbDzjtc18I=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/decision-framework/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" crossorigin="anonymous"
    onload="renderMathInElement(document.body, {
        delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false}
        ],
        throwOnError: false
    });"></script>



</head>

<body class="" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="WANG QICAI (Alt + H)">WANG QICAI</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://x.com/realWangQicai" title="X">
                    <span>X</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <a href="/" class="back-to-home">&larr; 返回目录</a>
    <h1 class="post-title entry-hint-parent">
      决策框架：整合所有概念
    </h1>
  </header>
  <div class="post-content"><h2 id="一个核心问题">一个核心问题<a hidden class="anchor" aria-hidden="true" href="#一个核心问题">#</a></h2>
<p>这个博客的所有文章，都在回答同一个问题：</p>
<p><strong>在不确定的世界里，如何做出好的决策？</strong></p>
<p>我们不能预测未来，我们的知识有限，我们的判断会出错。</p>
<p>在这种情况下，什么是正确的思维方式？</p>
<hr>
<h2 id="三层框架">三层框架<a hidden class="anchor" aria-hidden="true" href="#三层框架">#</a></h2>
<p>这18个概念可以组织成三个层次：</p>
<h3 id="第一层理解现实">第一层：理解现实<a hidden class="anchor" aria-hidden="true" href="#第一层理解现实">#</a></h3>
<p>在做任何决策之前，你需要正确理解你面对的世界。</p>
<p><strong>核心洞见</strong>：</p>
<ol>
<li>
<p><strong><a href="/posts/tail-risk/">尾部风险</a></strong>：极端事件比你以为的更常见，影响比你以为的更大。传统风险模型（正态分布）严重低估了尾部。</p>
</li>
<li>
<p><strong><a href="/posts/ergodicity/">遍历性</a></strong>：时间平均不等于集合平均。在乘性系统中，一次归零就是永远归零。生存是前提，不是目标。</p>
</li>
<li>
<p><strong><a href="/posts/survivorship-bias/">幸存者偏差</a></strong>：你看到的成功者是经过选择的样本，他们的经验不能简单复制。失败者的教训往往更有价值。</p>
</li>
<li>
<p><strong><a href="/posts/reflexivity/">反身性</a></strong>：市场不是被动反映现实，而是主动塑造现实。预期和现实互相影响，形成反馈循环。</p>
</li>
<li>
<p><strong><a href="/posts/lindy-effect/">林迪效应</a></strong>：在非生物系统中，存活时间本身是生命力的证据。经典比时尚更可靠。</p>
</li>
</ol>
<p><strong>这一层的教训</strong>：世界比你想象的更极端、更不可预测、更具欺骗性。大多数人系统性地低估不确定性。</p>
<hr>
<h3 id="第二层构建结构">第二层：构建结构<a hidden class="anchor" aria-hidden="true" href="#第二层构建结构">#</a></h3>
<p>理解现实之后，你需要设计能够在这种现实中生存和繁荣的结构。</p>
<p><strong>核心原则</strong>：</p>
<ol>
<li>
<p><strong><a href="/posts/convexity/">凸性</a></strong>：追求不对称性——上行大于下行。在变化中获益，而不是受损。</p>
</li>
<li>
<p><strong><a href="/posts/optionality/">选择权</a></strong>：保留选项的价值往往超过做出选择的价值。在不确定的世界里，灵活性是资产。</p>
</li>
<li>
<p><strong><a href="/posts/margin-of-safety/">安全边际</a></strong>：为错误留出空间。你会犯错，问题是犯错后是否还能生存。</p>
</li>
<li>
<p><strong><a href="/posts/barbell-strategy/">杠铃策略</a></strong>：不要在中间找平衡，把风险分离到两端。极端安全 + 极端冒险，没有中间。</p>
</li>
<li>
<p><strong><a href="/posts/opportunity-cost/">机会成本</a></strong>：每个选择都有代价。说&quot;是&quot;就是对其他选项说&quot;不&quot;。</p>
</li>
</ol>
<p><strong>这一层的教训</strong>：正确的结构比正确的预测更重要。你无法预测未来，但你可以设计一个在多种未来中都能表现良好的系统。</p>
<hr>
<h3 id="第三层执行决策">第三层：执行决策<a hidden class="anchor" aria-hidden="true" href="#第三层执行决策">#</a></h3>
<p>有了正确的理解和结构，你需要在具体情境中做出决策。</p>
<p><strong>核心工具</strong>：</p>
<ol>
<li>
<p><strong><a href="/posts/circle-of-competence/">能力圈</a></strong>：只在你真正理解的领域做决策。知道自己不知道什么，比知道什么更重要。</p>
</li>
<li>
<p><strong><a href="/posts/skin-in-the-game/">利益攸关</a></strong>：只信任有利益攸关的人的建议。没有代价的建议是廉价的。</p>
</li>
<li>
<p><strong><a href="/posts/inversion/">反向思维</a></strong>：与其问&quot;如何成功&quot;，不如问&quot;如何失败&quot;，然后避开那些事。</p>
</li>
<li>
<p><strong><a href="/posts/kelly-criterion/">凯利公式</a></strong>：根据优势和赔率计算最优下注比例。但在现实中，总是下注低于凯利值。</p>
</li>
<li>
<p><strong><a href="/posts/mean-reversion/">均值回归</a></strong>：极端值会向均值回归。不要把异常表现外推为永恒趋势。</p>
</li>
<li>
<p><strong><a href="/posts/sunk-cost/">沉没成本</a></strong>：已付出的成本不应影响未来决策。只看前方，不看后方。</p>
</li>
<li>
<p><strong><a href="/posts/compound-interest/">复利</a></strong>：长期持续的小优势，会产生巨大的累积效果。时间是复利的朋友。</p>
</li>
<li>
<p><strong><a href="/posts/expected-value/">期望值</a></strong>：决策的质量看期望值，不看单次结果。好决策可能有坏结果，坏决策可能有好结果。</p>
</li>
</ol>
<p><strong>这一层的教训</strong>：决策的目标不是&quot;正确&quot;，而是&quot;可重复的期望值为正&quot;。在你有优势的地方下注，在你没有优势的地方克制。</p>
<hr>
<h2 id="核心原则">核心原则<a hidden class="anchor" aria-hidden="true" href="#核心原则">#</a></h2>
<p>如果把所有概念蒸馏成几条核心原则，它们是：</p>
<h3 id="原则一生存优先">原则一：生存优先<a hidden class="anchor" aria-hidden="true" href="#原则一生存优先">#</a></h3>
<p><strong>在遍历性问题上，生存是唯一重要的目标。</strong></p>
<p>其他所有目标——回报、成就、声誉——都建立在生存的基础上。</p>
<ul>
<li>永远不要让任何单一事件能够摧毁你</li>
<li>宁可错过机会，也不要承担灭顶风险</li>
<li>在生存无忧的前提下，再考虑优化</li>
</ul>
<h3 id="原则二追求凸性">原则二：追求凸性<a hidden class="anchor" aria-hidden="true" href="#原则二追求凸性">#</a></h3>
<p><strong>设计上行大于下行的处境。</strong></p>
<p>不是预测哪个方向会发生，而是确保：如果好事发生，你能获益更多；如果坏事发生，你损失有限。</p>
<ul>
<li>买入选择权，而不是卖出选择权</li>
<li>保持灵活性和选项</li>
<li>用安全边际保护下行</li>
</ul>
<h3 id="原则三承认无知">原则三：承认无知<a hidden class="anchor" aria-hidden="true" href="#原则三承认无知">#</a></h3>
<p><strong>你的知识边界比你以为的更窄。</strong></p>
<ul>
<li>待在能力圈内</li>
<li>对不理解的事情说&quot;不&quot;</li>
<li>让有利益攸关的人教你，而不是没有的人</li>
</ul>
<h3 id="原则四反向思考">原则四：反向思考<a hidden class="anchor" aria-hidden="true" href="#原则四反向思考">#</a></h3>
<p><strong>避免愚蠢比追求聪明更重要。</strong></p>
<ul>
<li>列出会毁掉你的事，然后不做</li>
<li>从失败案例学习，而不只是成功案例</li>
<li>设置不可违反的硬性规则</li>
</ul>
<h3 id="原则五重视时间">原则五：重视时间<a hidden class="anchor" aria-hidden="true" href="#原则五重视时间">#</a></h3>
<p><strong>时间是不确定性的解药，也是不确定性的来源。</strong></p>
<ul>
<li>复利需要时间才能显现</li>
<li>林迪效应需要时间来验证</li>
<li>但时间也在衰减你的选择权</li>
</ul>
<hr>
<h2 id="决策清单">决策清单<a hidden class="anchor" aria-hidden="true" href="#决策清单">#</a></h2>
<p>面对重大决策时，问自己：</p>
<h3 id="关于风险">关于风险<a hidden class="anchor" aria-hidden="true" href="#关于风险">#</a></h3>
<ul>
<li><input disabled="" type="checkbox"> <strong>最坏情况是什么？</strong> 我能承受吗？（<a href="/posts/ergodicity/">遍历性</a>）</li>
<li><input disabled="" type="checkbox"> <strong>有没有尾部风险？</strong> 这个决策能否让我归零？（<a href="/posts/tail-risk/">尾部风险</a>）</li>
<li><input disabled="" type="checkbox"> <strong>我有足够的安全边际吗？</strong> 如果我的判断错了30%，结果还能接受吗？（<a href="/posts/margin-of-safety/">安全边际</a>）</li>
</ul>
<h3 id="关于能力">关于能力<a hidden class="anchor" aria-hidden="true" href="#关于能力">#</a></h3>
<ul>
<li><input disabled="" type="checkbox"> <strong>我真正理解这件事吗？</strong> 我能向一个10岁的孩子解释吗？（<a href="/posts/circle-of-competence/">能力圈</a>）</li>
<li><input disabled="" type="checkbox"> <strong>我的信息来源可靠吗？</strong> 给我建议的人有利益攸关吗？（<a href="/posts/skin-in-the-game/">利益攸关</a>）</li>
<li><input disabled="" type="checkbox"> <strong>我是不是在能力圈外假装自信？</strong> （<a href="/posts/survivorship-bias/">幸存者偏差</a>）</li>
</ul>
<h3 id="关于结构">关于结构<a hidden class="anchor" aria-hidden="true" href="#关于结构">#</a></h3>
<ul>
<li><input disabled="" type="checkbox"> <strong>这是凸的还是凹的？</strong> 上行和下行的不对称性如何？（<a href="/posts/convexity/">凸性</a>）</li>
<li><input disabled="" type="checkbox"> <strong>我在买入选择权还是卖出选择权？</strong> 我是获得灵活性还是放弃灵活性？（<a href="/posts/optionality/">选择权</a>）</li>
<li><input disabled="" type="checkbox"> <strong>我下注的比例合理吗？</strong> 有没有因为过度自信而下注过大？（<a href="/posts/kelly-criterion/">凯利公式</a>）</li>
</ul>
<h3 id="关于思维">关于思维<a hidden class="anchor" aria-hidden="true" href="#关于思维">#</a></h3>
<ul>
<li><input disabled="" type="checkbox"> <strong>如果这件事失败，最可能的原因是什么？</strong> （<a href="/posts/inversion/">反向思维</a>）</li>
<li><input disabled="" type="checkbox"> <strong>我有没有受到幸存者偏差的影响？</strong> 我只看到成功者了吗？（<a href="/posts/survivorship-bias/">幸存者偏差</a>）</li>
<li><input disabled="" type="checkbox"> <strong>我有没有受到沉没成本的影响？</strong> 我是在根据过去还是未来做决定？（<a href="/posts/sunk-cost/">沉没成本</a>）</li>
<li><input disabled="" type="checkbox"> <strong>我有没有把异常外推为趋势？</strong> （<a href="/posts/mean-reversion/">均值回归</a>）</li>
</ul>
<hr>
<h2 id="概念地图">概念地图<a hidden class="anchor" aria-hidden="true" href="#概念地图">#</a></h2>
<p>这些概念之间的关系：</p>
<pre tabindex="0"><code>理解现实
├── 尾部风险 ──→ 极端事件决定一切
├── 遍历性 ──→ 一次归零 = 永远归零
├── 幸存者偏差 ──→ 看不见的失败者
├── 反身性 ──→ 预期塑造现实
└── 林迪效应 ──→ 存活时间证明生命力

        ↓

构建结构
├── 凸性 ──→ 从波动中获益
├── 选择权 ──→ 保留未来的灵活性
├── 安全边际 ──→ 为错误留空间
├── 杠铃策略 ──→ 极端安全 + 极端冒险
└── 机会成本 ──→ 每个选择的代价

        ↓

执行决策
├── 能力圈 ──→ 只在理解的领域行动
├── 利益攸关 ──→ 只信任有风险的人
├── 反向思维 ──→ 避免愚蠢
├── 凯利公式 ──→ 控制下注比例
├── 均值回归 ──→ 极端值会回归
├── 沉没成本 ──→ 只看未来
├── 复利 ──→ 时间的力量
└── 期望值 ──→ 看过程不看结果
</code></pre><hr>
<h2 id="常见误用">常见误用<a hidden class="anchor" aria-hidden="true" href="#常见误用">#</a></h2>
<p>这些概念很容易被误解或滥用。以下是最常见的错误：</p>
<h3 id="1-把凯利公式当作精确工具">1. 把凯利公式当作精确工具<a hidden class="anchor" aria-hidden="true" href="#1-把凯利公式当作精确工具">#</a></h3>
<p><strong>误用</strong>：直接用凯利公式计算仓位，然后严格执行。</p>
<p><strong>问题</strong>：凯利公式假设你知道精确的概率和赔率。现实中你不知道。高估优势会导致过度下注。</p>
<p><strong>正确做法</strong>：使用半凯利或四分之一凯利。把凯利值当作上限，不是目标。</p>
<h3 id="2-把均值回归当作交易策略">2. 把均值回归当作交易策略<a hidden class="anchor" aria-hidden="true" href="#2-把均值回归当作交易策略">#</a></h3>
<p><strong>误用</strong>：&ldquo;这只股票跌了这么多，一定会涨回来。&rdquo;</p>
<p><strong>问题</strong>：统计上的均值回归不等于价格会回到历史水平。真实价值可能已经永久改变。你也不知道回归需要多长时间。</p>
<p><strong>正确做法</strong>：把均值回归当作认知工具（对极端值保持怀疑），而不是交易策略。</p>
<h3 id="3-误解安全边际">3. 误解安全边际<a hidden class="anchor" aria-hidden="true" href="#3-误解安全边际">#</a></h3>
<p><strong>误用</strong>：&ldquo;我买入价格低于估值30%，所以很安全。&rdquo;</p>
<p><strong>问题</strong>：如果你的估值是错的，安全边际就是假的。安全边际保护的是估值误差，不是分析错误。</p>
<p><strong>正确做法</strong>：安全边际只在能力圈内有效。先确保你理解这个生意，再谈安全边际。</p>
<h3 id="4-杠铃策略变成赌博">4. 杠铃策略变成赌博<a hidden class="anchor" aria-hidden="true" href="#4-杠铃策略变成赌博">#</a></h3>
<p><strong>误用</strong>：&ldquo;我把10%放在高风险投资上&rdquo;——然后选择了自己不理解的东西。</p>
<p><strong>问题</strong>：高风险部分应该是有限下行、无限上行的凸性结构，不是随便找的&quot;高风险&quot;资产。</p>
<p><strong>正确做法</strong>：高风险部分应该是真正的选择权——比如期权、早期创业投资——而不是高波动的凹性资产。</p>
<h3 id="5-用这些概念合理化不行动">5. 用这些概念合理化不行动<a hidden class="anchor" aria-hidden="true" href="#5-用这些概念合理化不行动">#</a></h3>
<p><strong>误用</strong>：&ldquo;遍历性告诉我不要冒险，所以我什么都不做。&rdquo;</p>
<p><strong>问题</strong>：避免破产不等于避免所有风险。生存是前提，不是目标。</p>
<p><strong>正确做法</strong>：在确保生存的前提下，积极寻找凸性机会。不行动本身也有机会成本。</p>
<hr>
<h2 id="最后的智慧">最后的智慧<a hidden class="anchor" aria-hidden="true" href="#最后的智慧">#</a></h2>
<p>塔勒布、巴菲特、芒格、索罗斯——这些思想家的共同点是什么？</p>
<p><strong>他们都深刻理解不确定性。</strong></p>
<p>他们不假装能预测未来。他们设计能够在多种未来中生存和繁荣的系统。</p>
<p>他们不追求最大回报。他们追求在最坏情况下也能生存，在好情况下能够获益的结构。</p>
<p>他们不相信&quot;这次不一样&quot;。他们尊重林迪效应和均值回归。</p>
<p>他们不听没有利益攸关的人的建议。他们只相信用真金白银承担后果的人。</p>
<p><strong>这不是悲观，是现实主义。</strong></p>
<p>承认不确定性不是软弱，而是智慧的开始。</p>
<hr>
<h2 id="一句话总结">一句话总结<a hidden class="anchor" aria-hidden="true" href="#一句话总结">#</a></h2>
<p><strong>在不确定的世界里，正确的结构比正确的预测更重要。</strong></p>
<p>先确保生存，再追求收益。先设计凸性，再寻找机会。先避免愚蠢，再追求聪明。</p>
<p>这是不确定性的智慧。</p>


  </div>

  <footer class="post-footer">
  </footer>
</article>
    </main>
    
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
</body>

</html>
